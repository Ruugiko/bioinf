<h1 align="center">Spatial Omics</h1>
<h2 align="center">Задание на анализ данных пациентов с плоскоклеточным раком</h2>

## Оглавление

[1. Описание прокта](#1-описание-проекта)

[2. Описание датасета](#2-описание-датасета)

[3. Задачи](#3-задачи)

[4. Выводы]()

## 1. Описание проекта

Отработка навыков статистического анализа данных на языке Pytnon на биоинформатическом датасете по простанственной [транскриптомике](https://institut-curie.org/popin/spatial-omics) пациентов с плоскоклеточным раком.

## 2. Описание датасета

Датасет содержит следующие признаки:

- *cell_type* - тип клетки;

- *cell_interaction* - клеточное микроокружение;

- *age_group* - возрастная группа пациента;

- *distance_to_vasculature* — расстояние до ближайших сосудов;

- *distance_to_largest_cell* — расстояние до ближайшей крупной клетки;

- *immune_marker_1* — экспрессия иммунного маркера 1 в данной клетке;

- *immune_marker_2* — экспрессия иммунного маркера 2 в данной клетке;

- *area_of_cell* — размер клетки;

- *case_id* — уникальный ID пациента.

## 3. Задачи

### Задание 1

Есть ли стат-значимость между типом клетки и:

а) Размером клетки (*area_of_cell*), добавьте 'hue' по возрастным группам.

б) Экспрессией иммунных маркеров (*immune_marker_1*, *immune_marker_2*), добавьте 'hue' по возрастным группам.

в) Дистанцией до ближайших объектов (*distance_to_vasculature*, *distance_to_largest_cell*), добавьте hue по возрастным группам.
В качестве ответов можно приводить 'box_plot'/'swarplot', где по одной оси будет тип клеток, а по другой — оцениваемая вами статистика.

### Задание 2

В каком клеточном микроокружении клеток какого типа статистически больше, чем в других микроокружениях? (колонка *cell_interaction*). Для ответа используйте 'box_plot'/'swarplot' с 'hue' по микроокружениям, где:

- по $О_х$ будут типы клеток,
- по $О_у$ — их количество.

Не забудьте посчитать количество для каждого пациента отдельно, иначе выборка не будет репрезентативной.

### Задание 3

Есть ли разница в доле микроокружения в тканях пациентов разных возрастов? Для ответа используйте 'box_plot'/'swarplot' с 'hue' по возрастным группам, где:

- по $О_х$ будут микроокружения,

- по $О_у$ — их доля в ткани пациента.

Не забудьте посчитать доли для каждого пациента отдельно, иначе выборка не будет репрезентативной.

### Задание 4

Правда ли, что иммунные клетки ('Immune type 1' и 'Immune type 2') лежат ближе к сосудам и крупным клеткам (Обе колонки *distance*), чем стромальные клетки ('Stroma cells') у молодых, но не у пожилых пациентов? Эту гипотезу нужно проверить бутстрапом (как разницу средних для двух выборок).

### Задание 5

Правда ли, что иммунные клетки в среднем лежат ближе к сосудам у молодых, но не у пожилых пациентов? Эту гипотезу необходимо проверить пермутационным тестом. В качестве исходной статистики берем массив с расстояниями только для данного типа клеток (длина - n), запоминаем среднее для каждого пациента. На каждой итерации набираем выборку размером n из всей! колонки с расстояниями до сосудов и смотрим соотношение с исходной статистикой. Проверяем гипотезы. Комбинировать p-values для каждой возрастной группы можно с помощью [этого инструмента](https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.combine_pvalues.html).

## Выводы

### Выводы по заданию 1

#### Задание 1_а
1) Проверка на нормальность показала следующие результаты:

![alt text](image.png)

![alt text](image-3.png)  

Значит можно сделать вывод о том, что выборка не подчиняется нормальному закону распределения.

2) Значение статистики теста Крассела-Уоллиса 7331.56 указывает на значительную разницу между средними значениями переменных 'area_of_cell' в разных группах ('cell_type' и 'age_group'), которая поддерживает предположение о различной эффективности этих групп на переменную 'area_of_cell'.
p-value  0.0 означает, что p-значение теста Крассела-Уоллиса является нулем, что подтверждает значимость различий между группами в отношении переменной 'area_of_cell'. Таким образом, можно заключить, что переменная 'area_of_cell' различается между группами (cell_type и age_group) на статистически значимый уровень.
Таким образом, на основе данных теста Крассела-Уоллиса можно сделать вывод о наличии статистически значимой связи между типом клетки и размером клетки с учетом возрастных групп.

![alt text](image-4.png)

3) Построенный boxplot можно использовать для оценки значимости и величины эффетка , на котором четко видно, что медианное значение типа клеток 'Largest cells' значимо отличается от остальных более чем в 2 раза

![alt text](image-2.png)

4) Для точной оценки величины можно воспользоваться вычислением коэффициента V Крамера, но стандартные функции для непосредственного вычисления величины эффекта отсутствуют в большинстве статистических пакетов, и это может потребовать дополнительных вычислений или использования каких-либо специализированных библиотек.

#### Задание 1_б

#### Задание 1_в

### Выводы по заданию 2

### Выводы по заданию 3

### Выводы по заданию 4

### Выводы по заданию 5